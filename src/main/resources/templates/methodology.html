<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng Ngh·ªá & M√¥ H√¨nh - RainAI</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3/lib/anime.min.js"></script>
    <style>
        /* Page Hero Section */
        .method-hero {
            background: linear-gradient(135deg, #2563eb 0%, #06b6d4 50%, #0ea5e9 100%);
            color: white;
            padding: 6rem 2rem;
            border-radius: var(--radius-2xl);
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
            animation: slideDown 0.8s ease-out;
            box-shadow: 0 20px 60px rgba(37, 99, 235, 0.3);
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .method-hero::before {
            content: '';
            position: absolute;
            top: -40%;
            right: -15%;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(50px);
            animation: float 6s ease-in-out infinite;
        }

        .method-hero::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.08) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(40px);
            animation: float 8s ease-in-out infinite reverse;
        }

        .method-hero .hero-title {
            position: relative;
            z-index: 10;
            font-size: clamp(2.5rem, 7vw, 4rem);
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            text-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            letter-spacing: -0.5px;
        }

        .method-hero .hero-desc {
            position: relative;
            z-index: 10;
            font-size: 1.15rem;
            opacity: 0.95;
            line-height: 1.8;
            margin-bottom: 2rem;
            font-weight: 400;
            max-width: 700px;
            animation: fadeInUp 0.8s ease-out 0.2s backwards;
        }

        .method-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Tech Cards with Enhanced Design */
        .tech-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: 3rem;
            box-shadow: var(--shadow-md);
            margin-bottom: 3rem;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease-out backwards;
        }

        .tech-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
            border-color: var(--primary);
        }

        .tech-card:nth-child(1) { animation-delay: 0.1s; }
        .tech-card:nth-child(2) { animation-delay: 0.2s; }
        .tech-card:nth-child(3) { animation-delay: 0.3s; }

        .tech-header {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--text-main);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid var(--primary);
        }

        /* Metrics Grid */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .metric-box {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 2.5rem;
            border-radius: var(--radius-lg);
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .metric-box:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }

        .metric-val {
            font-size: 2.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            margin-bottom: 0.75rem;
        }

        .metric-lbl {
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.05em;
        }

        /* Chart Container */
        .chart-wrapper {
            position: relative;
            height: 450px;
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.02) 0%, rgba(6, 182, 212, 0.02) 100%);
            border-radius: var(--radius-lg);
            padding: 2rem;
            border: 1px solid #e2e8f0;
        }

        /* Description Section */
        .description-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
            margin-top: 2rem;
        }

        .description-text {
            color: var(--text-secondary);
            line-height: 1.8;
            font-size: 1.05rem;
        }

        .description-text strong {
            color: var(--text-main);
            font-weight: 700;
        }

        .description-text ul {
            list-style: none;
            padding-left: 0;
            margin: 1.5rem 0;
        }

        .description-text li {
            padding-left: 2.5rem;
            position: relative;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .description-text li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .visual-placeholder {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            height: 350px;
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .visual-content {
            text-align: center;
        }

        .visual-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: spin 8s linear infinite;
        }

        .visual-text {
            font-size: 1.1rem;
            font-weight: 600;
            opacity: 0.95;
        }

        .error-message {
            padding: 2rem;
            background: #fee2e2;
            color: #991b1b;
            border-radius: var(--radius-lg);
            border-left: 4px solid #ef4444;
            font-weight: 600;
        }

        /* Feature Description Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .feature-item {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 2rem;
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-left-color: var(--secondary);
        }

        .feature-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 0.75rem;
        }

        .feature-desc {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        /* Highlight Box */
        .highlight-box {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 2.5rem;
            border-radius: var(--radius-xl);
            margin: 2rem 0;
            box-shadow: var(--shadow-lg);
        }

        .highlight-box h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            font-weight: 800;
        }

        .highlight-box p {
            margin: 0.75rem 0;
            opacity: 0.95;
            line-height: 1.6;
        }

        @media (max-width: 1024px) {
            .description-section {
                grid-template-columns: 1fr;
            }

            .tech-card {
                padding: 2rem;
            }

            .metric-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .method-container {
                padding: 0 1rem;
            }

            .tech-card {
                padding: 1.5rem;
                margin-bottom: 2rem;
            }

            .tech-header {
                font-size: 1.3rem;
            }

            .chart-wrapper {
                height: 300px;
                padding: 1rem;
            }

            .metric-grid {
                grid-template-columns: 1fr;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }

            .visual-placeholder {
                height: 250px;
            }

            .visual-icon {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
<div th:replace="fragments/header :: header"></div>

<main class="method-container">
    <!-- PAGE HERO -->
    <section class="cinematic-hero hero-bg-method">
        <div class="hero-content-box">
            <div class="hero-badge">
                <span>üî¨</span> <span>Khoa h·ªçc d·ªØ li·ªáu</span>
            </div>
            <h1 class="hero-title-new">C√¥ng Ngh·ªá L√µi RainAI</h1>
            <p class="hero-desc-new">
                Kh√°m ph√° c√°ch ch√∫ng t√¥i k·∫øt h·ª£p Machine Learning v√† d·ªØ li·ªáu Nhi·ªát ƒë·ªô b·ªÅ m·∫∑t ƒë·∫•t (LST) ƒë·ªÉ gi·∫£i b√†i to√°n d·ª± b√°o m∆∞a.
            </p>
        </div>
    </section>

    <!-- SECTION 1: MODEL PERFORMANCE -->
    <div class="tech-card">
        <div class="tech-header">
            <span>üìä</span> Hi·ªáu Su·∫•t M√¥ H√¨nh (Real-time)
        </div>

        <div th:if="${modelInfo != null}">
            <div class="metric-grid">
                <div class="metric-box">
                    <div class="metric-val" th:text="${modelInfo.metrics['gatekeeper_accuracy']}">0%</div>
                    <div class="metric-lbl">ƒê·ªô ch√≠nh x√°c ph√¢n lo·∫°i (M∆∞a/Kh√¥ng)</div>
                </div>
                <div class="metric-box">
                    <div class="metric-val" th:text="${modelInfo.metrics['specialist_r2']}">0.0</div>
                    <div class="metric-lbl">R¬≤ Score (ƒê·ªô kh·ªõp l∆∞·ª£ng m∆∞a)</div>
                </div>
                <div class="metric-box">
                    <div class="metric-val">15,000+</div>
                    <div class="metric-lbl">M·∫´u d·ªØ li·ªáu hu·∫•n luy·ªán (1984-2024)</div>
                </div>
            </div>

            <div class="highlight-box">
                <h3>‚ú® ƒê·∫∑c ƒêi·ªÉm N·ªïi B·∫≠t</h3>
                <p>‚úì S·ª≠ d·ª•ng ki·∫øn tr√∫c hai t·∫ßng: Gatekeeper (ph√¢n lo·∫°i m∆∞a/kh√¥ng) + Specialist (∆∞·ªõc l∆∞·ª£ng l∆∞·ª£ng m∆∞a)</p>
                <p>‚úì D·ªØ li·ªáu hu·∫•n luy·ªán t·ª´ 40 nƒÉm (1984-2024) t·ª´ to√†n Mi·ªÅn Trung</p>
                <p>‚úì ƒêang ƒë∆∞·ª£c c·∫£i thi·ªán li√™n t·ª•c v·ªõi d·ªØ li·ªáu th·ª±c t·∫ø</p>
            </div>
        </div>

        <div th:unless="${modelInfo != null}" class="error-message">
            ‚ö†Ô∏è Kh√¥ng th·ªÉ k·∫øt n·ªëi t·ªõi Model Python Server. Vui l√≤ng ki·ªÉm tra l·∫°i k·∫øt n·ªëi.
        </div>
    </div>

    <!-- SECTION 2: FEATURE IMPORTANCE -->
    <div class="tech-card">
        <div class="tech-header">
            <span>üéØ</span> Y·∫øu T·ªë ·∫¢nh H∆∞·ªüng Nh·∫•t
        </div>

        <p style="color: var(--text-secondary); margin-bottom: 2rem; line-height: 1.7;">
            Bi·ªÉu ƒë·ªì d∆∞·ªõi ƒë√¢y cho th·∫•y AI "coi tr·ªçng" y·∫øu t·ªë n√†o nh·∫•t khi ƒë∆∞a ra quy·∫øt ƒë·ªãnh d·ª± b√°o m∆∞a.
            D·ªØ li·ªáu ƒë∆∞·ª£c tr√≠ch xu·∫•t tr·ª±c ti·∫øp t·ª´ c·∫•u tr√∫c c√¢y quy·∫øt ƒë·ªãnh c·ªßa m√¥ h√¨nh Random Forest.
        </p>

        <div class="chart-wrapper">
            <canvas id="featureChart"></canvas>
        </div>

        <div class="feature-grid" style="margin-top: 3rem;">
            <div class="feature-item">
                <div class="feature-title">üå°Ô∏è Nhi·ªát ƒë·ªô B·ªÅ M·∫∑t (LST)</div>
                <div class="feature-desc">D·ª± b√°o b·ªëc h∆°i n∆∞·ªõc v√† h√¨nh th√†nh m√¢y. LST cao ‚Üí b·ªëc h∆°i tƒÉng ‚Üí xu h∆∞·ªõng m∆∞a cao.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">üíß ƒê·ªô ·∫®m Kh√¥ng Kh√≠</div>
                <div class="feature-desc">ƒê·ªô ·∫©m cao l√† ƒëi·ªÅu ki·ªán c·∫ßn thi·∫øt ƒë·ªÉ h√¨nh th√†nh m√¢y v√† m∆∞a. Th∆∞·ªùng k·∫øt h·ª£p v·ªõi LST.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">üìà M∆∞a Ng√†y H√¥m Tr∆∞·ªõc</div>
                <div class="feature-desc">M∆∞a h√¥m tr∆∞·ªõc c√≥ li√™n quan ƒë·∫øn h·ªá th·ªëng th·ªùi ti·∫øt, gi√∫p d·ª± b√°o kh·∫£ nƒÉng m∆∞a ti·∫øp theo.</div>
            </div>
        </div>
    </div>

    <!-- SECTION 3: LST EXPLANATION -->
    <div class="tech-card">
        <div class="tech-header">
            <span>üõ∞Ô∏è</span> Land Surface Temperature (LST) l√† g√¨?
        </div>

        <div class="description-section">
            <div class="description-text">
                <p><strong>Nhi·ªát ƒë·ªô b·ªÅ m·∫∑t ƒë·∫•t (LST)</strong> kh√°c v·ªõi nhi·ªát ƒë·ªô kh√¥ng kh√≠ m√† ch√∫ng ta c·∫£m nh·∫≠n. N√≥ l√† nhi·ªát ƒë·ªô l·ªõp ngo√†i c√πng c·ªßa tr√°i ƒë·∫•t, ƒë∆∞·ª£c ƒëo b·∫±ng c·∫£m bi·∫øn h·ªìng ngo·∫°i t·ª´ v·ªá tinh.</p>

                <p><strong>T·∫°i sao LST quan tr·ªçng trong d·ª± b√°o m∆∞a?</strong></p>
                <ul>
                    <li>Gi√∫p ph√°t hi·ªán s·ª± b·ªëc h∆°i n∆∞·ªõc t·ª´ m·∫∑t ƒë·∫•t (nguy√™n li·ªáu t·∫°o m√¢y).</li>
                    <li>T∆∞∆°ng quan ch·∫∑t ch·∫Ω v·ªõi ƒë·ªô ·∫©m ƒë·∫•t tr∆∞·ªõc khi m∆∞a.</li>
                    <li>Cung c·∫•p d·ªØ li·ªáu chi ti·∫øt h∆°n so v·ªõi c√°c tr·∫°m kh√≠ t∆∞·ª£ng th∆∞a th·ªõt.</li>
                    <li>Cho ph√©p d·ª± b√°o ·ªü v√πng s√¢u kh√¥ng c√≥ tr·∫°m ƒëo ch√≠nh th·ª©c.</li>
                </ul>

                <p><strong>Ngu·ªìn d·ªØ li·ªáu:</strong> V·ªá tinh MODIS (Moderate Resolution Imaging Spectroradiometer) t·ª´ NASA, c·∫≠p nh·∫≠t h√†ng ng√†y.</p>
            </div>

            <div class="visual-placeholder">
                <div class="visual-content">
                    <div class="visual-icon">üõ∞Ô∏è</div>
                    <div class="visual-text">D·ªØ li·ªáu V·ªá Tinh</div>
                    <p style="margin-top: 1rem; opacity: 0.8; font-size: 0.9rem;">D√†n c·∫£m bi·∫øn h·ªìng ngo·∫°i t·ª´ qu·ªπ ƒë·∫°o</p>
                </div>
            </div>
        </div>

        <div class="highlight-box" style="margin-top: 2.5rem;">
            <h3>üì° C√°ch V·ªá Tinh ƒêo LST</h3>
            <p>V·ªá tinh MODIS quay quanh Tr√°i ƒê·∫•t 2 l·∫ßn/ng√†y, ƒëo b·ª©c x·∫° h·ªìng ngo·∫°i t·ª´ b·ªÅ m·∫∑t. Th√¥ng qua c√°c c√¥ng th·ª©c v·∫≠t l√Ω, ta t√≠nh to√°n ƒë∆∞·ª£c nhi·ªát ƒë·ªô b·ªÅ m·∫∑t. ƒê·ªô ph√¢n gi·∫£i kho·∫£ng 1km¬≤, cho ph√©p ta th·∫•y chi ti·∫øt t·ª´ng khu v·ª±c nh·ªè trong Mi·ªÅn Trung.</p>
        </div>
    </div>

    <!-- SECTION 4: TECHNICAL SPECS -->
    <div class="tech-card">
        <div class="tech-header">
            <span>‚öôÔ∏è</span> Chi Ti·∫øt K·ªπ Thu·∫≠t
        </div>

        <div class="feature-grid">
            <div class="feature-item">
                <div class="feature-title">Ki·∫øn Tr√∫c M√¥ H√¨nh</div>
                <div class="feature-desc">Random Forest v·ªõi 2 t·∫ßng: Gatekeeper (ph√¢n lo·∫°i) + Specialist (h·ªìi quy). T·ªïng c·ªông 200+ c√¢y quy·∫øt ƒë·ªãnh.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">ƒê·∫ßu V√†o (Features)</div>
                <div class="feature-desc">LST, nhi·ªát ƒë·ªô KK, ƒë·ªô ·∫©m, t·ªëc ƒë·ªô gi√≥, ƒëi·ªÉm s∆∞∆°ng, c√πng c√°c ƒë·∫∑c tr∆∞ng kh√¥ng gian v√† th·ªùi gian.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">X·ª≠ L√Ω D·ªØ Li·ªáu</div>
                <div class="feature-desc">Chu·∫©n h√≥a Z-score, x·ª≠ l√Ω d·ªØ li·ªáu thi·∫øu b·∫±ng trung b√¨nh 3 ng√†y, validation 10-fold cross-validation.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">Th·ªùi Gian D·ª± B√°o</div>
                <div class="feature-desc">D·ª± b√°o ng√†y h√¥m nay d·ª±a tr√™n d·ªØ li·ªáu s√°ng c√πng ng√†y. C·∫≠p nh·∫≠t 2-4 l·∫ßn m·ªói ng√†y.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">ƒê·ªô Ch√≠nh X√°c</div>
                <div class="feature-desc">L·ªói RMSE trung b√¨nh 15-20mm. Hi·ªáu su·∫•t t·ªët nh·∫•t ·ªü m√πa m∆∞a, k√©m h∆°n ·ªü v√πng n√∫i cao.</div>
            </div>
            <div class="feature-item">
                <div class="feature-title">Gi·ªõi H·∫°n</div>
                <div class="feature-desc">Kh√¥ng d·ª± b√°o ch√≠nh x√°c m∆∞a gi√¥ng ƒë·ªôt ng·ªôt. Hi·ªáu su·∫•t h·∫°n ch·∫ø ·ªü v√πng c√≥ ƒë·ªãa h√¨nh ph·ª©c t·∫°p.</div>
            </div>
        </div>
    </div>
</main>

<div th:replace="fragments/footer :: footer"></div>

<script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener("DOMContentLoaded", function() {
        const modelInfo = /*[[${modelInfo}]]*/ null;

        if (modelInfo && modelInfo.feature_importance) {
            const ctx = document.getElementById('featureChart');
            const labels = modelInfo.feature_importance.slice(0, 10).map(f => f.name);
            const data = modelInfo.feature_importance.slice(0, 10).map(f => f.score);

            const nameMap = {
                'lst': 'Nhi·ªát ƒë·ªô b·ªÅ m·∫∑t (LST)',
                'humidity': 'ƒê·ªô ·∫©m',
                'rain_lag_1': 'M∆∞a h√¥m qua',
                'rain_mean_3d': 'TB M∆∞a 3 ng√†y',
                'dew_point': 'ƒêi·ªÉm s∆∞∆°ng',
                'temperature': 'Nhi·ªát ƒë·ªô KK',
                'wind_speed': 'T·ªëc ƒë·ªô gi√≥',
                'heat_index': 'Ch·ªâ s·ªë nhi·ªát',
                'lat': 'Vƒ© ƒë·ªô',
                'lon': 'Kinh ƒë·ªô'
            };
            const niceLabels = labels.map(l => nameMap[l] || l);

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: niceLabels,
                    datasets: [{
                        label: 'M·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng (%)',
                        data: data.map(x => (x * 100).toFixed(2)),
                        backgroundColor: [
                            'rgba(37, 99, 235, 0.8)',
                            'rgba(6, 182, 212, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(249, 115, 22, 0.8)',
                            'rgba(168, 85, 247, 0.8)',
                            'rgba(236, 72, 153, 0.8)',
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(14, 165, 233, 0.8)',
                            'rgba(132, 204, 22, 0.8)',
                            'rgba(244, 114, 182, 0.8)'
                        ],
                        borderColor: [
                            'rgb(37, 99, 235)',
                            'rgb(6, 182, 212)',
                            'rgb(34, 197, 94)',
                            'rgb(249, 115, 22)',
                            'rgb(168, 85, 247)',
                            'rgb(236, 72, 153)',
                            'rgb(59, 130, 246)',
                            'rgb(14, 165, 233)',
                            'rgb(132, 204, 22)',
                            'rgb(244, 114, 182)'
                        ],
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'top' },
                        tooltip: { backgroundColor: 'rgba(0,0,0,0.7)', titleColor: '#fff', bodyColor: '#fff', padding: 12, borderRadius: 8 }
                    },
                    scales: {
                        x: { beginAtZero: true, max: 100, ticks: { callback: function(value) { return value + '%'; } } }
                    }
                }
            });
        }

        // Page animations
        anime({
            targets: '.tech-card',
            translateY: [30, 0],
            opacity: [0, 1],
            duration: 800,
            delay: anime.stagger(100),
            easing: 'easeOutQuad'
        });
    });
    /*]]>*/
</script>
</body>
</html>
