<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trang ch·ªß - RainAI System</title>
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

  <style>
    /* --- HERO SECTION (NEW BACKGROUND) --- */
    .cinematic-hero {
        position: relative;
        padding: 8rem 2rem;
        margin-bottom: 3rem;
        border-radius: 24px;
        overflow: hidden;
        color: white;
        text-align: center;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        min-height: 550px;
        display: flex;
        align-items: center;
        justify-content: center;
        isolation: isolate;
    }

    /* ·∫¢nh n·ªÅn m·ªõi: B·∫ßu tr·ªùi b√£o k·ªãch t√≠nh */
    .hero-bg-layer {
        position: absolute; inset: 0; z-index: -2;
        /* ·∫¢nh Unsplash: Stormy Coast */
        background: url('https://images.unsplash.com/photo-1504608524841-42fe6f032b4b?q=80&w=1920&auto=format&fit=crop') center/cover no-repeat;
        filter: brightness(0.6) contrast(1.1);
        transition: transform 10s ease;
    }

    .cinematic-hero:hover .hero-bg-layer { transform: scale(1.05); }

    .hero-content-box { max-width: 900px; position: relative; z-index: 1; }

    .hero-title-new {
        font-size: 3.5rem; font-weight: 800; margin-bottom: 1.5rem;
        text-shadow: 0 4px 15px rgba(0,0,0,0.6); line-height: 1.1; letter-spacing: -1px;
    }

    .hero-desc-new {
        font-size: 1.25rem; color: rgba(255, 255, 255, 0.95); margin-bottom: 2.5rem;
        font-weight: 500; text-shadow: 0 2px 4px rgba(0,0,0,0.5); max-width: 700px; margin-left: auto; margin-right: auto;
    }

    /* --- PROVINCE CARDS --- */
    .forecast-grid {
        display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;
    }

    .province-card {
        position: relative; height: 300px; border-radius: 20px; overflow: hidden;
        color: white; cursor: pointer; transition: all 0.4s ease;
        box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        display: flex; flex-direction: column; justify-content: flex-end; padding: 1.5rem;
    }

    .province-bg {
        position: absolute; inset: 0; background-size: cover; background-position: center;
        transition: transform 0.6s ease; z-index: 0;
    }

    .province-overlay {
        position: absolute; inset: 0; z-index: 1;
        background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.3) 60%, rgba(0,0,0,0) 100%);
    }

    .province-info { position: relative; z-index: 2; }

    .province-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.3); }
    .province-card:hover .province-bg { transform: scale(1.1); }

    .temp-badge {
        position: absolute; top: 1rem; right: 1rem; z-index: 2;
        background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(8px);
        padding: 6px 12px; border-radius: 50px; font-weight: 700; border: 1px solid rgba(255,255,255,0.2);
    }

    /* --- SAFETY GUIDE --- */
    .guide-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; margin-top: 2rem; }
    .guide-card {
        background: white; padding: 2rem; border-radius: 16px; border: 1px solid #e2e8f0;
        text-align: center; transition: all 0.3s;
    }
    .guide-card:hover { border-color: #2563eb; transform: translateY(-5px); box-shadow: 0 10px 30px rgba(37, 99, 235, 0.1); }
    .guide-icon { font-size: 3rem; margin-bottom: 1rem; display: block; }

    /* --- SATELLITE --- */
    .satellite-box {
        position: relative; border-radius: 24px; overflow: hidden; height: 450px;
        display: flex; align-items: center; justify-content: center;
        margin-top: 5rem; color: white; text-align: center;
        box-shadow: 0 20px 50px rgba(15, 23, 42, 0.3);
    }
    .sat-bg {
        position: absolute; inset: 0;
        background: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1920') center/cover;
        filter: brightness(0.6); transition: transform 10s ease;
    }
    .satellite-box:hover .sat-bg { transform: scale(1.05); }
    .sat-content { position: relative; z-index: 2; max-width: 600px; padding: 2rem; }

    @media(max-width: 768px) {
        .hero-title-new { font-size: 2.2rem; }
        .guide-grid { grid-template-columns: 1fr; }
        .cinematic-hero { padding: 4rem 1.5rem; min-height: 400px; }
    }
  </style>
</head>

<body>
<div th:replace="~{fragments/header :: header}"></div>

<main class="app-container">

  <section class="cinematic-hero">
    <div class="hero-bg-layer"></div>
    <div class="hero-content-box">
      <div style="display: inline-block; padding: 0.5rem 1rem; border: 1px solid rgba(255,255,255,0.3); border-radius: 50px; background: rgba(255,255,255,0.1); backdrop-filter: blur(5px); margin-bottom: 1.5rem; font-weight: 600; font-size: 0.9rem;">
        üáªüá≥ H·ªá th·ªëng D·ª± b√°o M∆∞a Mi·ªÅn Trung
      </div>
      <h1 class="hero-title-new">Ch·ªß ƒê·ªông ·ª®ng Ph√≥ <br> Tr∆∞·ªõc M·ªçi C∆°n B√£o</h1>
      <p class="hero-desc-new">
        C√¥ng ngh·ªá AI k·∫øt h·ª£p d·ªØ li·ªáu v·ªá tinh LST mang ƒë·∫øn c·∫£nh b√°o s·ªõm, ch√≠nh x√°c cho 11 t·ªânh th√†nh duy√™n h·∫£i Mi·ªÅn Trung.
      </p>

      <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        <a href="/prediction" class="btn-hero-action" style="background: #2563eb; color: white; border: none; padding: 1rem 2.5rem; font-size: 1.1rem; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.5);">
          ‚ö° D·ª± b√°o ngay
        </a>
        <a href="#forecast" class="btn-hero-action" style="background: rgba(255,255,255,0.15); color: white; border: 1px solid rgba(255,255,255,0.3); backdrop-filter: blur(10px); padding: 1rem 2.5rem; font-size: 1.1rem;">
          Xem c√°c t·ªânh
        </a>
      </div>
    </div>
  </section>

  <section id="forecast">
    <div style="display: flex; justify-content: space-between; align-items: end; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
      <div>
        <h2 style="font-size: 2rem; color: #0f172a; margin-bottom: 0.5rem; font-weight: 800;">Th·ªùi ti·∫øt 11 T·ªânh Th√†nh</h2>
        <p style="color: #64748b;">C·∫≠p nh·∫≠t realtime. ·∫¢nh n·ªÅn l√† ƒë·ªãa danh ƒë·∫∑c tr∆∞ng c·ªßa t·ª´ng t·ªânh.</p>
      </div>
      <div class="filter-section" style="margin: 0;">
        <button class="filter-btn active" onclick="filterForecast('all', this)">T·∫•t c·∫£</button>
        <button class="filter-btn" onclick="filterForecast('high', this)">‚ö†Ô∏è M∆∞a to</button>
        <button class="filter-btn" onclick="filterForecast('safe', this)">‚òÄÔ∏è T·∫°nh r√°o</button>
      </div>
    </div>

    <div class="forecast-grid">
      <div class="province-card js-card"
           th:each="item : ${forecasts}"
           th:data-rain="${item.predictedRainfall}"
           th:onclick="'window.location.href=\'/api/forecast?locationId=' + ${item.location.id} + '\''">

        <div class="temp-badge" th:if="${item.predictionFeature != null}">
          <span th:text="${item.predictionFeature.inputTemp}">--</span>¬∞C
        </div>

        <div class="province-bg"
             th:style="'background-image: url(' + ${
                        item.location.name.contains('Thanh H√≥a') ? '/images/samson.jpg' :
                        item.location.name.contains('Ngh·ªá An') ? '/images/quebac.jpg' :
                        item.location.name.contains('H√† Tƒ©nh') ? '/images/hatinh.jpg' :
                        item.location.name.contains('Qu·∫£ng Tr·ªã') ? '/images/thanhco.jpg' :
                        item.location.name.contains('Hu·∫ø') ? '/images/hue.jpg' :
                        item.location.name.contains('ƒê√† N·∫µng') ? '/images/cauvang.jpg' :
                        item.location.name.contains('Qu·∫£ng Ng√£i') ? '/images/lyson.jpg' :
                        item.location.name.contains('Gia Lai') ? '/images/bienho.jpg' :
                        item.location.name.contains('ƒê·∫Øk L·∫Øk') ? '/images/buondon.jpg' :
                        item.location.name.contains('Kh√°nh H√≤a') ? '/images/nhatrang.jpg' :
                        item.location.name.contains('L√¢m ƒê·ªìng') ? '/images/dalat.jpg' :
                        '/images/default_rain.jpg'
                     } + ');'">
        </div>

        <div class="province-overlay"></div>

        <div class="province-info">
          <h3 th:text="${item.location.name}" style="font-size: 1.6rem; margin-bottom: 0.2rem; font-weight: 800; text-shadow: 0 2px 10px rgba(0,0,0,0.8);">T√™n T·ªânh</h3>
          <p style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 1rem;">Mi·ªÅn Trung</p>

          <div style="display: flex; align-items: center; gap: 1rem;">
            <span style="font-size: 2.5rem; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.4));">
                <span th:if="${item.predictedRainfall == 0}">üå§Ô∏è</span>
                <span th:if="${item.predictedRainfall > 0 and item.predictedRainfall <= 16}">üå¶Ô∏è</span>
                <span th:if="${item.predictedRainfall > 16 and item.predictedRainfall <= 50}">üåßÔ∏è</span>
                <span th:if="${item.predictedRainfall > 50}">‚õàÔ∏è</span>
            </span>

            <div>
              <div style="font-size: 0.75rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 1px;">D·ª± b√°o 24h</div>
              <div style="font-size: 1.6rem; font-weight: 800; color: #60a5fa; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
                <span th:text="${#numbers.formatDecimal(item.predictedRainfall, 1, 1)}">0.0</span> mm
              </div>
            </div>
          </div>

          <div th:if="${item.predictedRainfall > 50}" style="margin-top: 1rem;">
            <span style="background: #ef4444; color: white; padding: 6px 14px; border-radius: 6px; font-size: 0.85rem; font-weight: 700; box-shadow: 0 4px 10px rgba(239, 68, 68, 0.5); display: inline-block;">
                ‚ö†Ô∏è C·∫¢NH B√ÅO M∆ØA L·ªöN
            </span>
          </div>
        </div>
      </div>

      <div th:if="${#lists.isEmpty(forecasts)}" style="grid-column: 1/-1; text-align: center; padding: 4rem; background: #f8fafc; border-radius: 16px;">
        <div style="font-size: 3rem; margin-bottom: 1rem;">üì≠</div>
        <p style="color: #64748b; font-size: 1.1rem;">Ch∆∞a c√≥ d·ªØ li·ªáu d·ª± b√°o. Vui l√≤ng ch·∫°y m√¥ h√¨nh d·ª± b√°o.</p>
        <a href="/prediction" class="btn-modern btn-primary" style="margin-top: 1rem; display: inline-block;">ƒê·∫øn trang d·ª± b√°o</a>
      </div>
    </div>
  </section>

  <section id="safety-guide" style="margin-top: 6rem;">
    <div style="text-align: center; max-width: 700px; margin: 0 auto 3rem auto;">
      <span style="color: #2563eb; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; font-size: 0.9rem;">Survival Guide</span>
      <h2 style="font-size: 2.2rem; color: #0f172a; margin: 0.5rem 0 1rem 0; font-weight: 800;">K·ªπ NƒÉng ·ª®ng Ph√≥ Thi√™n Tai</h2>
      <p style="color: #475569; font-size: 1.1rem;">Chu·∫©n b·ªã k·ªπ l∆∞·ª°ng l√† ch√¨a kh√≥a ƒë·ªÉ b·∫£o v·ªá an to√†n cho b·∫£n th√¢n v√† gia ƒë√¨nh.</p>
    </div>

    <div class="guide-grid">
      <div class="guide-card">
        <span class="guide-icon">üè†</span>
        <h3 style="margin-bottom: 0.8rem; color: #1e293b; font-weight: 700;">Tr∆∞·ªõc khi b√£o ƒë·∫øn</h3>
        <p style="font-size: 0.95rem; color: #64748b; line-height: 1.6;">Gia c·ªë m√°i nh√†, c·ª≠a s·ªï. Chu·∫©n b·ªã t√∫i kh·∫©n c·∫•p (ƒë√®n pin, thu·ªëc, l∆∞∆°ng kh√¥). X√°c ƒë·ªãnh n∆°i s∆° t√°n an to√†n.</p>
        <a href="/safety" style="color: #2563eb; font-weight: 600; font-size: 0.9rem; margin-top: 1.5rem; display: inline-block;">Xem checklist chi ti·∫øt &rarr;</a>
      </div>
      <div class="guide-card">
        <span class="guide-icon">‚ö°</span>
        <h3 style="margin-bottom: 0.8rem; color: #1e293b; font-weight: 700;">Trong c∆°n b√£o</h3>
        <p style="font-size: 0.95rem; color: #64748b; line-height: 1.6;">·ªû y√™n trong nh√†, tr√°nh xa c·ª≠a k√≠nh. Ng·∫Øt ngu·ªìn ƒëi·ªán n·∫øu n∆∞·ªõc tr√†n v√†o. Theo d√µi tin t·ª©c li√™n t·ª•c.</p>
        <a href="/safety" style="color: #2563eb; font-weight: 600; font-size: 0.9rem; margin-top: 1.5rem; display: inline-block;">K·ªπ nƒÉng sinh t·ªìn &rarr;</a>
      </div>
      <div class="guide-card">
        <span class="guide-icon">‚õëÔ∏è</span>
        <h3 style="margin-bottom: 0.8rem; color: #1e293b; font-weight: 700;">Sau b√£o l≈©</h3>
        <p style="font-size: 0.95rem; color: #64748b; line-height: 1.6;">Ki·ªÉm tra ngu·ªìn n∆∞·ªõc u·ªëng. D·ªçn d·∫πp v·ªá sinh ph√≤ng d·ªãch b·ªánh. C·∫©n th·∫≠n v·ªõi d√¢y ƒëi·ªán ƒë·ª©t v√† c√¢y ƒë·ªï.</p>
        <a href="/safety" style="color: #2563eb; font-weight: 600; font-size: 0.9rem; margin-top: 1.5rem; display: inline-block;">Ph·ª•c h·ªìi sau b√£o &rarr;</a>
      </div>
    </div>
  </section>

  <section class="satellite-box">
    <div class="sat-bg"></div>
    <div class="sat-content">
      <h2 style="font-size: 2.8rem; margin-bottom: 1rem; font-weight: 800; text-shadow: 0 4px 10px rgba(0,0,0,0.5);">G√≥c Nh√¨n T·ª´ V·ªá Tinh</h2>
      <p style="font-size: 1.2rem; margin-bottom: 2.5rem; color: rgba(255,255,255,0.9); max-width: 600px; margin-left: auto; margin-right: auto;">
        Quan s√°t tr·ª±c quan v√πng m√¢y ƒë·ªëi l∆∞u v√† nhi·ªát ƒë·ªô b·ªÅ m·∫∑t ƒë·∫•t (LST) tr√™n b·∫£n ƒë·ªì s·ªë t∆∞∆°ng t√°c th·ªùi gian th·ª±c.
      </p>
      <a href="/map" class="btn-hero-action" style="background: white; color: #0f172a; border: none; padding: 1rem 2.5rem; font-weight: 700;">
        üåç M·ªü b·∫£n ƒë·ªì v·ªá tinh
      </a>
    </div>
  </section>

</main>

<div th:replace="~{fragments/footer :: footer}"></div>

<script>
  function filterForecast(type, btnElement) {
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      btnElement.classList.add('active');

      const cards = document.querySelectorAll('.js-card');
      let visibleCount = 0;

      cards.forEach(card => {
          const rain = parseFloat(card.getAttribute('data-rain'));
          let isVisible = false;

          if (type === 'all') isVisible = true;
          else if (type === 'high' && rain > 50) isVisible = true;
          else if (type === 'safe' && rain <= 16) isVisible = true;

          if (isVisible) {
              card.style.display = 'flex';
              visibleCount++;
          } else {
              card.style.display = 'none';
          }
      });
  }
</script>

</body>
</html>