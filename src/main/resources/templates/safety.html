<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>K·ªπ NƒÉng & C·∫£nh B√°o - RainAI</title>
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/animejs@3/lib/anime.min.js"></script>
  <style>
    .safety-wrapper {
        max-width: 1200px; margin: 30px auto; padding: 0 20px;
    }

    /* 1. ALERT BOX STYLE */
    .alert-box {
        padding: 25px; border-radius: 16px; margin-bottom: 40px; display: none;
        border-left: 8px solid; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        animation: slideDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .alert-warning { background: linear-gradient(to right, #fffbeb, #fff); color: #92400e; border-color: #f59e0b; }
    .alert-danger { background: linear-gradient(to right, #fef2f2, #fff); color: #b91c1c; border-color: #ef4444; }
    .alert-safe { background: linear-gradient(to right, #f0fdf4, #fff); color: #166534; border-color: #22c55e; }

    /* 2. TABBED INTERFACE LAYOUT */
    .handbook-container {
        display: flex; gap: 30px; min-height: 600px;
    }

    /* Sidebar Menu */
    .handbook-sidebar {
        flex: 0 0 280px;
        background: white; border-radius: 16px; padding: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.02); height: fit-content;
    }
    .tab-btn {
        display: block; width: 100%; text-align: left;
        padding: 15px 20px; margin-bottom: 8px; border-radius: 10px;
        border: none; background: transparent; color: #64748b;
        font-weight: 600; cursor: pointer; transition: all 0.2s;
        display: flex; align-items: center; gap: 12px;
        font-size: 0.95rem;
    }
    .tab-btn:hover { background: #f1f5f9; color: #334155; }
    .tab-btn.active {
        background: #e0f2fe; color: #0284c7;
        box-shadow: 0 2px 4px rgba(2, 132, 199, 0.1);
    }
    .tab-icon { font-size: 1.2rem; width: 24px; text-align: center; }

    /* Content Area */
    .handbook-content {
        flex: 1; background: white; border-radius: 16px; padding: 40px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05); position: relative;
    }
    .tab-pane { display: none; animation: fadeIn 0.4s ease-out; }
    .tab-pane.active { display: block; }

    h2.section-title { color: #1e293b; margin-top: 0; font-size: 1.8rem; border-bottom: 2px solid #f1f5f9; padding-bottom: 15px; margin-bottom: 20px; }
    h3.sub-title { color: #334155; margin-top: 25px; margin-bottom: 10px; font-size: 1.2rem; display: flex; align-items: center; gap: 8px;}

    .checklist-item {
        display: flex; align-items: flex-start; gap: 15px; padding: 12px 0; border-bottom: 1px dashed #e2e8f0;
        transition: background 0.2s;
    }
    .checklist-item:hover { background: #f8fafc; padding-left: 10px; border-radius: 6px; }
    .checklist-item input[type="checkbox"] {
        width: 20px; height: 20px; accent-color: #0284c7; cursor: pointer; margin-top: 2px;
    }
    .checklist-item label { cursor: pointer; line-height: 1.5; color: #475569; }

    .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px; }
    .info-card { background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0; }
    .info-card strong { display: block; margin-bottom: 5px; color: #0f172a; }

    .important-note {
        background: #fff7ed; border-left: 4px solid #f97316; padding: 15px; margin: 20px 0; border-radius: 4px; color: #9a3412;
    }

    @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeIn { from { opacity: 0; transform: translateX(10px); } to { opacity: 1; transform: translateX(0); } }

    @media (max-width: 768px) {
        .handbook-container { flex-direction: column; }
        .handbook-sidebar { width: 100%; flex: none; display: flex; overflow-x: auto; padding: 10px; gap: 10px; scrollbar-width: none; }
        .tab-btn { width: auto; white-space: nowrap; margin-bottom: 0; background: #f8fafc; padding: 10px 15px; }
        .handbook-content { padding: 20px; }
    }
  </style>
</head>
<body>
<div th:replace="fragments/header :: header"></div>

<main class="safety-wrapper">
  <div class="page-hero" style="text-align: center; margin-bottom: 40px;">
    <h1 class="hero-title" style="font-size: 2.5rem;">C·∫©m Nang Sinh T·ªìn 4.0</h1>
    <p class="hero-desc">Ki·∫øn th·ª©c chu·∫©n h√≥a ƒë·ªÉ ·ª©ng ph√≥ v·ªõi thi√™n tai t·∫°i Mi·ªÅn Trung</p>
  </div>

  <!-- 1. DYNAMIC ALERT (T·ª± ƒë·ªông hi·ªán) -->
  <div id="dynamicAlert"></div>

  <!-- 2. HANDBOOK CONTENT -->
  <div class="handbook-container">

    <!-- SIDEBAR MENU -->
    <div class="handbook-sidebar">
      <button class="tab-btn active" onclick="switchTab('tab-prep')">
        <span class="tab-icon">üè†</span> Tr∆∞·ªõc khi b√£o
      </button>
      <button class="tab-btn" onclick="switchTab('tab-during')">
        <span class="tab-icon">‚õàÔ∏è</span> Trong khi b√£o
      </button>
      <button class="tab-btn" onclick="switchTab('tab-after')">
        <span class="tab-icon">üßπ</span> Sau khi b√£o
      </button>
      <button class="tab-btn" onclick="switchTab('tab-kit')">
        <span class="tab-icon">üéí</span> T√∫i kh·∫©n c·∫•p
      </button>
      <button class="tab-btn" onclick="switchTab('tab-firstaid')">
        <span class="tab-icon">üöë</span> S∆° c·∫•p c·ª©u
      </button>
      <button class="tab-btn" onclick="switchTab('tab-contact')">
        <span class="tab-icon">üìû</span> S·ªë kh·∫©n c·∫•p
      </button>
    </div>

    <!-- CONTENT AREA -->
    <div class="handbook-content">

      <!-- TAB 1: PREPARATION (TR∆Ø·ªöC B√ÉO) -->
      <div id="tab-prep" class="tab-pane active">
        <h2 class="section-title">Chu·∫©n B·ªã & Gia C·ªë Nh√† C·ª≠a</h2>
        <p>Th·ª±c hi·ªán c√°c b∆∞·ªõc n√†y ngay khi c√≥ tin c·∫£nh b√°o b√£o/l≈© t·ª´ 48-24 gi·ªù tr∆∞·ªõc.</p>

        <h3 class="sub-title">üõ°Ô∏è Gia c·ªë b√™n ngo√†i</h3>
        <div class="checklist-item">
          <input type="checkbox" id="p1">
          <label for="p1"><strong>M√°i nh√†:</strong> Ki·ªÉm tra m√°i t√¥n, d√πng bao c√°t ho·∫∑c t√∫i n∆∞·ªõc ch√®n l√™n m√°i ƒë·ªÉ ch·ªëng t·ªëc m√°i.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="p2">
          <label for="p2"><strong>C√¢y c·ªëi:</strong> C·∫Øt t·ªâa c√†nh c√¢y l·ªõn quanh nh√† ƒë·ªÉ tr√°nh g√£y ƒë·ªï v√†o ƒë∆∞·ªùng d√¢y ƒëi·ªán ho·∫∑c m√°i nh√†.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="p3">
          <label for="p3"><strong>C·ª≠a k√≠nh:</strong> D√°n bƒÉng d√≠nh h√¨nh ch·ªØ X l√™n c√°c c·ª≠a k√≠nh l·ªõn ƒë·ªÉ gi·∫£m nguy c∆° v·ª° v·ª•n khi c√≥ gi√≥ gi·∫≠t.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="p4">
          <label for="p4"><strong>Tho√°t n∆∞·ªõc:</strong> Kh∆°i th√¥ng c·ªëng r√£nh xung quanh nh√† gi√∫p n∆∞·ªõc tho√°t nhanh h∆°n.</label>
        </div>

        <h3 class="sub-title">üì¶ D·ª± tr·ªØ b√™n trong</h3>
        <div class="checklist-item">
          <input type="checkbox" id="p5">
          <label for="p5">D·ª± tr·ªØ n∆∞·ªõc s·∫°ch (3 l√≠t/ng∆∞·ªùi/ng√†y) v√† th·ª±c ph·∫©m kh√¥ (m√¨ t√¥m, l∆∞∆°ng kh√¥) ƒë·ªß d√πng cho 3-5 ng√†y.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="p6">
          <label for="p6">S·∫°c ƒë·∫ßy pin ƒëi·ªán tho·∫°i, s·∫°c d·ª± ph√≤ng, ƒë√®n pin.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="p7">
          <label for="p7">K√™ cao ƒë·ªì ƒë·∫°c, ƒë·∫∑c bi·ªát l√† thi·∫øt b·ªã ƒëi·ªán v√† h√≥a ch·∫•t ƒë·ªôc h·∫°i.</label>
        </div>
      </div>

      <!-- TAB 2: DURING STORM (TRONG B√ÉO) -->
      <div id="tab-during" class="tab-pane">
        <h2 class="section-title">H√†nh ƒê·ªông Khi B√£o ƒê·ªï B·ªô</h2>
        <div class="important-note">
          <strong>QUY T·∫ÆC V√ÄNG:</strong> "·ªû y√™n trong nh√† ki√™n c·ªë, tr√°nh xa c·ª≠a s·ªï v√† c·ª≠a ra v√†o."
        </div>

        <div class="info-grid">
          <div class="info-card">
            <strong>üîå ƒêi·ªán & Gas</strong>
            Ng·∫Øt c·∫ßu dao ƒëi·ªán t·ªïng (CB) v√† kh√≥a van b√¨nh gas ngay l·∫≠p t·ª©c n·∫øu n∆∞·ªõc b·∫Øt ƒë·∫ßu tr√†n v√†o nh√†.
          </div>
          <div class="info-card">
            <strong>üö´ Kh√¥ng l·ªôi n∆∞·ªõc</strong>
            Kh√¥ng l·ªôi qua v√πng n∆∞·ªõc ng·∫≠p n·∫øu n∆∞·ªõc cao tr√™n ƒë·∫ßu g·ªëi ho·∫∑c ch·∫£y xi·∫øt. Coi ch·ª´ng h·ªë ga m·∫•t n·∫Øp.
          </div>
          <div class="info-card">
            <strong>üì± Th√¥ng tin</strong>
            Lu√¥n b·∫≠t Radio ho·∫∑c theo d√µi ·ª©ng d·ª•ng RainAI ƒë·ªÉ c·∫≠p nh·∫≠t di·ªÖn bi·∫øn m∆∞a l≈©.
          </div>
          <div class="info-card">
            <strong>üöó N·∫øu ƒëang l√°i xe</strong>
            Tuy·ªát ƒë·ªëi kh√¥ng c·ªë bƒÉng qua ng·∫ßm tr√†n. ƒê·ªó xe v√†o n∆°i cao r√°o, tr√°nh g·ªëc c√¢y, c·ªôt ƒëi·ªán.
          </div>
        </div>

        <h3 class="sub-title">‚ö†Ô∏è N·∫øu nh√† c√≥ nguy c∆° s·∫≠p/ng·∫≠p s√¢u:</h3>
        <ul style="color: #475569; line-height: 1.6;">
          <li>B√¨nh tƒ©nh di chuy·ªÉn sang nh√† h√†ng x√≥m ki√™n c·ªë h∆°n ho·∫∑c ƒëi·ªÉm s∆° t√°n c√¥ng c·ªông.</li>
          <li>Ch·ªâ mang theo <strong>T√∫i kh·∫©n c·∫•p</strong> v√† gi·∫•y t·ªù quan tr·ªçng.</li>
          <li>M·∫∑c √°o phao ho·∫∑c mang theo v·∫≠t d·ª•ng c√≥ th·ªÉ n·ªïi (can nh·ª±a r·ªóng).</li>
        </ul>
      </div>

      <!-- TAB 3: AFTER STORM (SAU B√ÉO) -->
      <div id="tab-after" class="tab-pane">
        <h2 class="section-title">Kh·∫Øc Ph·ª•c H·∫≠u Qu·∫£ Sau B√£o</h2>
        <p>Nguy hi·ªÉm v·∫´n c√≤n ngay c·∫£ khi b√£o ƒë√£ tan. H√£y c·∫©n tr·ªçng.</p>

        <div class="checklist-item">
          <input type="checkbox" id="a1">
          <label for="a1"><strong>Ki·ªÉm tra ƒëi·ªán:</strong> Kh√¥ng b·∫≠t ƒëi·ªán ngay. H√£y ki·ªÉm tra xem h·ªá th·ªëng c√≥ b·ªã ng·∫≠p n∆∞·ªõc hay r√≤ r·ªâ kh√¥ng.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="a2">
          <label for="a2"><strong>V·ªá sinh:</strong> D·ªçn d·∫πp x√°c ƒë·ªông v·∫≠t ch·∫øt, r√°c th·∫£i ƒë·ªÉ ph√≤ng d·ªãch b·ªánh. S·ª≠ d·ª•ng v√¥i b·ªôt ho·∫∑c Cloramin B.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="a3">
          <label for="a3"><strong>N∆∞·ªõc u·ªëng:</strong> Tuy·ªát ƒë·ªëi ƒÉn ch√≠n u·ªëng s√¥i. Kh·ª≠ tr√πng n∆∞·ªõc b·∫±ng vi√™n l·ªçc n∆∞·ªõc n·∫øu ngu·ªìn n∆∞·ªõc b·ªã √¥ nhi·ªÖm.</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="a4">
          <label for="a4"><strong>Ki·ªÉm tra nh√†:</strong> Ch·ª•p ·∫£nh h∆∞ h·∫°i (n·∫øu c√≥) ƒë·ªÉ l√†m th·ªß t·ª•c b·∫£o hi·ªÉm ho·∫∑c xin h·ªó tr·ª£.</label>
        </div>
      </div>

      <!-- TAB 4: EMERGENCY KIT (T√öI KH·∫®N C·∫§P) -->
      <div id="tab-kit" class="tab-pane">
        <h2 class="section-title">T√∫i C·ª©u H·ªô (Go-Bag)</h2>
        <p>H√£y chu·∫©n b·ªã s·∫µn m·ªôt balo ch·ªëng n∆∞·ªõc ch·ª©a c√°c v·∫≠t d·ª•ng sau cho 72 gi·ªù sinh t·ªìn.</p>

        <h3 class="sub-title">üíß Nhu y·∫øu ph·∫©m</h3>
        <ul class="checklist-style">
          <li>N∆∞·ªõc u·ªëng: 3-5 chai 1.5 l√≠t.</li>
          <li>Th·ª±c ph·∫©m: L∆∞∆°ng kh√¥, m√¨ t√¥m, ƒë·ªì h·ªôp (k√®m ƒë·ªì khui), s√¥-c√¥-la (nƒÉng l∆∞·ª£ng cao).</li>
        </ul>

        <h3 class="sub-title">üíä Y t·∫ø & V·ªá sinh</h3>
        <ul class="checklist-style">
          <li>B√¥ng bƒÉng, g·∫°c, thu·ªëc s√°t tr√πng (Povidine).</li>
          <li>Thu·ªëc h·∫° s·ªët, thu·ªëc ti√™u h√≥a, thu·ªëc d·ªã ·ª©ng.</li>
          <li>Kh·∫©u trang, n∆∞·ªõc r·ª≠a tay kh√¥.</li>
          <li>BƒÉng v·ªá sinh (d√πng cho ph·ª• n·ªØ ho·∫∑c c·∫ßm m√°u v·∫øt th∆∞∆°ng l·ªõn).</li>
        </ul>

        <h3 class="sub-title">üî¶ D·ª•ng c·ª• sinh t·ªìn</h3>
        <ul class="checklist-style">
          <li>ƒê√®n pin (lo·∫°i si√™u s√°ng) + Pin d·ª± ph√≤ng.</li>
          <li>C√≤i c·ª©u h·ªô (ƒë·ªÉ b√°o hi·ªáu khi b·ªã k·∫πt).</li>
          <li>B·∫≠t l·ª≠a, dao ƒëa nƒÉng.</li>
          <li>√Åo m∆∞a b·ªô, chƒÉn m·ªèng.</li>
          <li><strong>Gi·∫•y t·ªù:</strong> CCCD, S·ªï ƒë·ªè (b·∫£n sao), ti·ªÅn m·∫∑t (b·ªçc trong t√∫i zip ch·ªëng n∆∞·ªõc).</li>
        </ul>
      </div>

      <!-- TAB 5: FIRST AID (S∆† C·∫§P C·ª®U) -->
      <div id="tab-firstaid" class="tab-pane">
        <h2 class="section-title">K·ªπ NƒÉng S∆° C·∫•p C·ª©u C∆° B·∫£n</h2>

        <div class="info-card" style="margin-bottom: 15px; border-left: 4px solid #ef4444;">
          <h3 style="margin-top:0; color:#b91c1c;">üöë ƒêu·ªëi n∆∞·ªõc</h3>
          <ol style="padding-left: 20px;">
            <li>ƒê∆∞a n·∫°n nh√¢n ra kh·ªèi n∆∞·ªõc nhanh ch√≥ng.</li>
            <li>Ki·ªÉm tra h∆°i th·ªü. N·∫øu ng·ª´ng th·ªü, th·ª±c hi·ªán <strong>√©p tim l·ªìng ng·ª±c (CPR)</strong> ngay l·∫≠p t·ª©c.</li>
            <li>H√† h∆°i th·ªïi ng·∫°t k·∫øt h·ª£p √©p tim theo t·ª∑ l·ªá 30 l·∫ßn √©p : 2 l·∫ßn th·ªïi.</li>
            <li>Gi·ªØ ·∫•m c∆° th·ªÉ, thay qu·∫ßn √°o kh√¥.</li>
          </ol>
        </div>

        <div class="info-card" style="margin-bottom: 15px; border-left: 4px solid #f59e0b;">
          <h3 style="margin-top:0; color:#92400e;">‚ö° ƒêi·ªán gi·∫≠t</h3>
          <ol style="padding-left: 20px;">
            <li><strong>Tuy·ªát ƒë·ªëi kh√¥ng ch·∫°m tr·ª±c ti·∫øp</strong> v√†o n·∫°n nh√¢n khi ngu·ªìn ƒëi·ªán ch∆∞a ng·∫Øt.</li>
            <li>Ng·∫Øt c·∫ßu dao ho·∫∑c d√πng v·∫≠t c√°ch ƒëi·ªán (g·∫≠y g·ªó kh√¥, nh·ª±a) g·∫°t d√¢y ƒëi·ªán ra.</li>
            <li>Ki·ªÉm tra nh·ªãp tim, h√¥ h·∫•p v√† s∆° c·ª©u nh∆∞ ƒëu·ªëi n∆∞·ªõc n·∫øu c·∫ßn.</li>
          </ol>
        </div>

        <div class="info-card" style="margin-bottom: 15px; border-left: 4px solid #3b82f6;">
          <h3 style="margin-top:0; color:#1e40af;">ü©∏ V·∫øt th∆∞∆°ng ch·∫£y m√°u</h3>
          <ol style="padding-left: 20px;">
            <li>R·ª≠a s·∫°ch v·∫øt th∆∞∆°ng b·∫±ng n∆∞·ªõc s·∫°ch ho·∫∑c n∆∞·ªõc mu·ªëi.</li>
            <li>D√πng v·∫£i s·∫°ch ho·∫∑c bƒÉng g·∫°c √©p ch·∫∑t l√™n v·∫øt th∆∞∆°ng ƒë·ªÉ c·∫ßm m√°u.</li>
            <li>K√™ cao ph·∫ßn b·ªã th∆∞∆°ng cao h∆°n tim (n·∫øu c√≥ th·ªÉ).</li>
          </ol>
        </div>
      </div>

      <!-- TAB 6: CONTACT (LI√äN L·∫†C) -->
      <div id="tab-contact" class="tab-pane">
        <h2 class="section-title">Danh B·∫° Kh·∫©n C·∫•p</h2>
        <p>H√£y l∆∞u c√°c s·ªë n√†y v√†o ƒëi·ªán tho·∫°i ngay b√¢y gi·ªù.</p>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div style="background: #fee2e2; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #fecaca;">
            <div style="font-size: 2.5rem; font-weight: 800; color: #dc2626;">114</div>
            <div style="font-weight: bold; color: #991b1b;">C·ª®U H·ªéA & C·ª®U N·∫†N</div>
            <div style="font-size: 0.85rem; margin-top: 5px;">G·ªçi khi ng·∫≠p l·ª•t, s·∫≠p nh√†, m·∫Øc k·∫πt</div>
          </div>

          <div style="background: #dcfce7; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #bbf7d0;">
            <div style="font-size: 2.5rem; font-weight: 800; color: #16a34a;">115</div>
            <div style="font-weight: bold; color: #166534;">C·∫§P C·ª®U Y T·∫æ</div>
            <div style="font-size: 0.85rem; margin-top: 5px;">G·ªçi khi c√≥ ng∆∞·ªùi b·ªã th∆∞∆°ng</div>
          </div>

          <div style="background: #e0f2fe; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #bae6fd;">
            <div style="font-size: 2.5rem; font-weight: 800; color: #0284c7;">112</div>
            <div style="font-weight: bold; color: #075985;">T√åM KI·∫æM C·ª®U N·∫†N</div>
            <div style="font-size: 0.85rem; margin-top: 5px;">Ph·∫°m vi to√†n qu·ªëc</div>
          </div>

          <div style="background: #f1f5f9; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #cbd5e1;">
            <div style="font-size: 2.5rem; font-weight: 800; color: #475569;">1900...</div>
            <div style="font-weight: bold; color: #334155;">ƒêI·ªÜN L·ª∞C</div>
            <div style="font-size: 0.85rem; margin-top: 5px;">B√°o s·ª± c·ªë m·∫•t ƒëi·ªán/r√≤ ƒëi·ªán</div>
          </div>
        </div>

        <div class="important-note" style="margin-top: 30px; background: #f0f9ff; border-left-color: #0ea5e9; color: #0369a1;">
          <strong>M·∫πo nh·ªè:</strong> H√£y vi·∫øt s·ªë ƒëi·ªán tho·∫°i c·ªßa ng∆∞·ªùi th√¢n v√† b·ªè v√†o t√∫i nilon trong t√∫i kh·∫©n c·∫•p. Ph√≤ng khi ƒëi·ªán tho·∫°i h·∫øt pin ho·∫∑c b·ªã h·ªèng do n∆∞·ªõc.
        </div>
      </div>

    </div>
  </div>
</main>

<script>
  // Tab Switching Logic
  function switchTab(tabId) {
      // Remove active class from all buttons and panes
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));

      // Add active to clicked button and target pane
      event.currentTarget.classList.add('active');
      document.getElementById(tabId).classList.add('active');
  }

  // Dynamic Alert Logic
  document.addEventListener("DOMContentLoaded", function() {
      const lastPred = JSON.parse(localStorage.getItem('lastPrediction'));
      const alertDiv = document.getElementById('dynamicAlert');

      if (lastPred) {
          const rain = lastPred.rain;
          const location = lastPred.location || 'khu v·ª±c c·ªßa b·∫°n';
          const timeDiff = (new Date() - new Date(lastPred.timestamp)) / 1000 / 60; // minutes

          // Show alert if prediction was within last 30 mins
          if (timeDiff < 30) {
              let html = '';
              if (rain > 100) {
                  html = `
                      <div class="alert-box alert-danger" style="display:block">
                          <h3 style="margin-top:0; font-size:1.4rem;">üö® B√ÅO ƒê·ªòNG ƒê·ªé T·∫†I ${location.toUpperCase()}</h3>
                          <p style="font-size: 1.1rem; margin: 10px 0;">D·ª± b√°o m∆∞a c·ª±c l·ªõn (${rain.toFixed(1)}mm). Nguy c∆° ng·∫≠p l·ª•t di·ªán r·ªông.</p>
                          <div style="font-weight: 700; background: rgba(255,255,255,0.5); padding: 10px; border-radius: 8px;">
                              KHUY·∫æN NGH·ªä: Xem ngay m·ª•c "T√∫i kh·∫©n c·∫•p" v√† "S∆° c·∫•p c·ª©u".
                          </div>
                      </div>
                  `;
                  // Auto switch to Kit tab
                  switchTab('tab-kit');
                  document.querySelectorAll('.tab-btn')[3].classList.add('active'); // Highlight Kit button
                  document.querySelectorAll('.tab-btn')[0].classList.remove('active'); // Remove default
              } else if (rain > 50) {
                  html = `
                      <div class="alert-box alert-warning" style="display:block">
                          <h3 style="margin-top:0; font-size:1.4rem;">‚ö†Ô∏è C·∫¢NH B√ÅO M∆ØA L·ªöN</h3>
                          <p style="font-size: 1.1rem;">Khu v·ª±c ${location} s·∫Øp c√≥ m∆∞a to (${rain.toFixed(1)}mm).</p>
                          <p>H√£y ki·ªÉm tra m√°i nh√† (Tab "Tr∆∞·ªõc khi b√£o") ngay.</p>
                      </div>
                  `;
              }
              if(html) alertDiv.innerHTML = html;
          }
      }
  });
</script>
</body>
</html>